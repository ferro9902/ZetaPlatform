# =============================================================================
# User Auth Service - Application Configuration
# =============================================================================
# Kubernetes deployment notes:
#   - Properties marked [ConfigMap] → go into the k8s ConfigMap
#   - Properties marked [Secret]    → reference a k8s Secret via envFrom / env
#   - Properties marked [Default]   → hardcoded defaults, no override needed
# =============================================================================

# [Default] Service identity
spring.application.name=user-auth-service

# -----------------------------------------------------------------------------
# Virtual Threads (JDK 21+)
# -----------------------------------------------------------------------------
# [Default]
spring.threads.virtual.enabled=true

# -----------------------------------------------------------------------------
# gRPC Server
# -----------------------------------------------------------------------------
# [ConfigMap] Port on which this service exposes its gRPC API to other pods
spring.grpc.server.port=9090

# -----------------------------------------------------------------------------
# gRPC Client Channels
# -----------------------------------------------------------------------------
# [ConfigMap] Internal cluster DNS name for the user-mgmt sibling service
spring.grpc.client.channels.user-mgmt.address=static://user-mgmt-service:9090

# -----------------------------------------------------------------------------
# DataSource (PostgreSQL)
# -----------------------------------------------------------------------------
# [Secret]  Injected from Kubernetes Secret (DB_URL)
spring.datasource.url=${DB_URL}
# [Secret]  Injected from Kubernetes Secret (DB_USERNAME)
spring.datasource.username=${DB_USERNAME}
# [Secret]  Injected from Kubernetes Secret (DB_PASSWORD)
spring.datasource.password=${DB_PASSWORD}

# -----------------------------------------------------------------------------
# JPA / Hibernate
# -----------------------------------------------------------------------------
# [Default] Do not auto-create or alter schema in production; use Flyway/Liquibase
spring.jpa.hibernate.ddl-auto=validate
# [Default] Disable open-session-in-view anti-pattern
spring.jpa.open-in-view=false

# -----------------------------------------------------------------------------
# Flyway — Schema migrations
# -----------------------------------------------------------------------------
# [Default] Flyway runs automatically on startup before Hibernate validates the schema
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration

# -----------------------------------------------------------------------------
# Security — Internal JWT Tokens
# -----------------------------------------------------------------------------
# [Secret]  HMAC-SHA256 secret used to sign and verify internal JWTs
#           Injected from Kubernetes Secret (ZETA_AUTH_INTERNAL_HMAC_SECRET)
zeta.auth.internal.hmac-secret=${ZETA_AUTH_INTERNAL_HMAC_SECRET}
# [ConfigMap] Token lifetime in seconds (default: 3600 = 1 hour)
zeta.auth.internal.token-validity-seconds=${ZETA_AUTH_TOKEN_VALIDITY_SECONDS:3600}

# -----------------------------------------------------------------------------
# Security — OAuth2 Token Encryption at Rest
# -----------------------------------------------------------------------------
# [Secret]  AES-256-GCM master key (Base64-encoded 32-byte key)
#           Injected from Kubernetes Secret (ZETA_ENCRYPTION_MASTER_KEY)
zeta.auth.encryption.master-key=${ZETA_ENCRYPTION_MASTER_KEY}

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
# [ConfigMap] Log levels (JSON format output handled by logback-spring.xml)
logging.level.root=INFO
logging.level.com.aruba.zeta=INFO

# -----------------------------------------------------------------------------
# Actuator / Observability
# -----------------------------------------------------------------------------
# [Default] Endpoints exposed for health probes, Prometheus scraping, log-level changes
management.endpoints.web.exposure.include=health,info,loggers,metrics,prometheus
management.endpoint.health.probes.enabled=true
